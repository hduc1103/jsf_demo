<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">

<h:head>
	<title>Employee List</title>
</h:head>
<h:body>
	<h:form id="employeeList">
		<h:panelGroup rendered="#{employeeBean.showList}">
			<h1>Employee List</h1>
			<h:dataTable value="#{employeeBean.employees}" var="emp" border="3"
				style="width: 100%; border-collapse: none; text-align: left;">

				<h:column style="width: 10%;">
					<f:facet name="header">
						<h:outputText value="Employee Code" />
					</f:facet>
					<h:outputText value="#{emp.code}" />
				</h:column>

				<h:column style="width: 40%;">
					<f:facet name="header">
						<h:outputText value="Name" />
					</f:facet>
					<h:outputText value="#{emp.name}" />
				</h:column>

				<h:column style="width: 10%;">
					<f:facet name="header">
						<h:outputText value="Age" />
					</f:facet>
					<h:outputText value="#{emp.age}" />
				</h:column>

				<h:column style="width: 20%;">
					<f:facet name="header">
						<h:outputText value="Date of Birth" />
					</f:facet>
					<h:outputText value="#{emp.dob}" />
				</h:column>
				<h:column style="width: 10%;">
					<h:commandButton value="Delete"
						actionListener="#{employeeBean.deleteEmployee(emp.code)}"
						style="color: red;  width: 100%; padding: 5px; border: none;cursor: pointer;" />
				</h:column>
				<h:column style="width: 10%;">
					<h:commandButton value="Update"
						actionListener="#{employeeBean.toggleUpdate(emp)}"
						style="color: blue; width: 100%; padding: 5px; border: none;cursor: pointer;">
						<f:ajax render="updateEmployeeForm employeeList" />
					</h:commandButton>

				</h:column>
			</h:dataTable>
			<h:commandButton value="Sort by name"
				actionListener="#{employeeBean.sortByName()}"
				style="cursor:pointer;">
				<f:ajax render="employeeList" />
			</h:commandButton>
			<h:commandButton value="Sort by age"
				actionListener="#{employeeBean.sortByAge()}" style="cursor:pointer;">
				<f:ajax render="employeeList" />
			</h:commandButton>
			<h:commandButton value="Sort by date of birth"
				actionListener="#{employeeBean.sortByDob()}" style="cursor:pointer;">
				<f:ajax render="employeeList" />
			</h:commandButton>
			<h:commandButton value="Refresh"
				actionListener="#{employeeBean.refresh()}" style="cursor:pointer;">
				<f:ajax render="employeeList" />
			</h:commandButton>
			<h:commandButton value="Add"
				actionListener="#{employeeBean.toggleAdd()}" style="cursor:pointer">
				<f:ajax render="addEmployeeForm employeeList" />
			</h:commandButton>
		</h:panelGroup>
	</h:form>

	<h:form id="addEmployeeForm">
		<h:panelGroup rendered="#{employeeBean.showAdd}">

			<h2>Add New Employee</h2>
			<h:panelGrid columns="3">
				<h:outputLabel for="code" value="Code:" />
				<h:inputText id="code" value="#{employeeBean.newEmployee.code}"
					required="true" validatorMessage="Code must be in format CODE001">
					<f:validateRegex pattern="^CODE\d+$" />
				</h:inputText>
				<h:message for="code" style="color:red;" />
				<h:outputLabel for="name" value="Name:" />
				<h:inputText id="name" value="#{employeeBean.newEmployee.name}"
					required="true"
					validatorMessage="Name must contain two words, each starting with uppercase">
					<f:validateRegex pattern="^[A-Z][a-z]+ [A-Z][a-z]+$" />
				</h:inputText>
				<h:message for="name" style="color:red;" />

				<h:outputLabel for="dob" value="Date of Birth:" />
				<h:inputText id="dob" value="#{employeeBean.newEmployee.dob}"
					required="true">
					<f:convertDateTime pattern="yyyy-MM-dd" />
				</h:inputText>
				<h:message for="dob" style="color:red;" />
				<h:commandButton value="Add Employee" style="cursor:pointer;"
					actionListener="#{employeeBean.addEmployee}">
					<f:ajax execute="@form" render="employeeList addEmployeeForm" />
				</h:commandButton>

				<h:commandButton value="Cancel" style="cursor:pointer;"
					immediate="true">
					<f:ajax listener="#{employeeBean.cancelAdd()}"
						render="addEmployeeForm employeeList" />
				</h:commandButton>

			</h:panelGrid>
		</h:panelGroup>
		<h:messages globalOnly="true" style="color:red;" />

	</h:form>

	<h:form id="updateEmployeeForm">
		<h:panelGroup rendered="#{employeeBean.showUpdate}">
			<h2>Update Employee with code #{employeeBean.curEmployee.code}</h2>

			<h:panelGrid columns="3">
				<h:outputLabel for="name" value="Name:" />
				<h:inputText id="name" value="#{employeeBean.curEmployee.name}"
					required="true" validatorMessage="Code must be in format CODE001">
					<f:validateRegex pattern="^[A-Z][a-z]+ [A-Z][a-z]+$" />
					<f:attribute name="errorMessage"
						value="Name must contain two words, each starting with uppercase" />
				</h:inputText>
				<h:message for="name" style="color:red;" />
				<h:outputLabel for="dob" value="Date of Birth:" />
				<h:inputText id="dob" value="#{employeeBean.curEmployee.dob}"
					required="true"
					validatorMessage="Date of birth must be in format 2025-01-01">
					<f:convertDateTime pattern="yyyy-MM-dd" />
				</h:inputText>
				<h:message for="dob" style="color:red;" />
				<h:commandButton value="Update Employee"
					actionListener="#{employeeBean.updateEmployee}"
					style="cursor:pointer;">
					<f:ajax execute="@form" render="employeeList updateEmployeeForm" />
				</h:commandButton>

				<h:commandButton value="Cancel"
					actionListener="#{employeeBean.cancelUpdate()}"
					style="cursor:pointer;" immediate="true">
					<f:ajax render="updateEmployeeForm employeeList" />
				</h:commandButton>
			</h:panelGrid>
		</h:panelGroup>
		<h:messages globalOnly="true" style="color:red;" />
	</h:form>
</h:body>

</html>
